# eTracee - åŸºäºeBPFçš„ç³»ç»Ÿè°ƒç”¨ç›‘æ§ç³»ç»Ÿ

> è½»é‡çº§eBPFç³»ç»Ÿè°ƒç”¨ç›‘æ§å·¥å…·ï¼Œå®æ—¶æ•è·å’Œåˆ†æç³»ç»Ÿè¡Œä¸º

## ğŸ¯ é¡¹ç›®ç®€ä»‹

**eTracee** æ˜¯ä¸€ä¸ªåŸºäºeBPFæŠ€æœ¯çš„ç³»ç»Ÿè°ƒç”¨ç›‘æ§å·¥å…·ï¼Œä¸“æ³¨äºå®æ—¶æ•è·å’Œåˆ†æLinuxç³»ç»Ÿçš„å…³é”®ç³»ç»Ÿè°ƒç”¨ã€‚é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„eBPF CO-RE (Compile Once, Run Everywhere) æŠ€æœ¯ï¼Œæä¾›é«˜æ€§èƒ½ã€ä½å¼€é”€çš„å†…æ ¸çº§ç›‘æ§èƒ½åŠ›ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ” **å…¨é¢ç›‘æ§**: ç›‘æ§17ç§å…³é”®ç³»ç»Ÿè°ƒç”¨ï¼Œè¦†ç›–è¿›ç¨‹ã€æ–‡ä»¶ã€ç½‘ç»œã€å†…å­˜ã€æƒé™ç­‰å®‰å…¨åœºæ™¯
- âš¡ **é«˜æ€§èƒ½ä¼ è¾“**: ä½¿ç”¨Ring Bufferå®ç°é«˜æ•ˆçš„å†…æ ¸-ç”¨æˆ·æ€æ•°æ®ä¼ è¾“
- ğŸ¯ **å¨èƒæ£€æµ‹**: æ”¯æŒä»£ç æ³¨å…¥ã€æƒé™æå‡ã€è¿›ç¨‹è°ƒè¯•ã€Rootkitç­‰é«˜çº§å¨èƒæ£€æµ‹
- ğŸ“Š **ç»“æ„åŒ–è¾“å‡º**: æ ‡å‡†JSONæ ¼å¼è¾“å‡ºï¼Œä¾¿äºåç»­å¤„ç†å’Œåˆ†æ
- ğŸš€ **CO-REå…¼å®¹**: ä¸€æ¬¡ç¼–è¯‘ï¼Œå¤šå†…æ ¸ç‰ˆæœ¬è¿è¡Œ
- ğŸ›¡ï¸ **è½»é‡è®¾è®¡**: æœ€å°åŒ–ç³»ç»Ÿèµ„æºå ç”¨å’Œæ€§èƒ½å½±å“

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Linux Kernel Space                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  eBPF Program (probe.c)                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ execve tracepointâ”‚  â”‚openat tracepointâ”‚  â”‚connect traceâ”‚ â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚   point     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                â”‚
â”‚                           â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Ring Buffer (256KB)                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼ (é«˜æ•ˆæ•°æ®ä¼ è¾“)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    User Space                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Go Program (ebpf_receiver)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Event Parser   â”‚  â”‚ Timestamp Fix   â”‚  â”‚JSON Output  â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                â”‚
â”‚                           â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚         Structured JSON Event Stream                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Linux (å†…æ ¸ç‰ˆæœ¬ >= 4.18ï¼Œæ”¯æŒeBPF CO-RE)
- **ç¼–è¯‘ç¯å¢ƒ**: clang, llvm, libbpf-dev
- **è¿è¡Œæƒé™**: rootæƒé™æˆ–CAP_BPFèƒ½åŠ›
- **Goç‰ˆæœ¬**: >= 1.19
- **å†…å­˜**: >= 1GB RAM
- **å­˜å‚¨**: >= 500MB å¯ç”¨ç©ºé—´

### ç¯å¢ƒå‡†å¤‡

#### Ubuntu/Debianç³»ç»Ÿ
```bash
sudo apt-get update
sudo apt-get install -y clang llvm libbpf-dev bpftool
```

#### CentOS/RHEL/openEulerç³»ç»Ÿ
```bash
sudo yum install -y clang llvm libbpf-devel bpftool
```

### ç¼–è¯‘å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/2577552541/eTracee.git
cd eTracee

# ä¸€é”®æ„å»º
make

# æˆ–åˆ†æ­¥æ„å»º
make ebpf      # ç¼–è¯‘eBPFç¨‹åº
make go-build  # æ„å»ºGoç¨‹åº
```

### è¿è¡Œç›‘æ§

```bash
# å¯åŠ¨ç³»ç»Ÿè°ƒç”¨ç›‘æ§ (éœ€è¦rootæƒé™)
sudo ./bin/ebpf_receiver
```

### éªŒè¯å®‰è£…

```bash
# æ£€æŸ¥æ„å»ºçŠ¶æ€
make status

# è¿è¡ŒåŸºç¡€æµ‹è¯•
make test
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
eTracee/
â”œâ”€â”€ Makefile                    # é¡¹ç›®ä¸»æ„å»ºæ–‡ä»¶
â”œâ”€â”€ README.md                   # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ bin/                        # ç¼–è¯‘è¾“å‡ºç›®å½•
â”‚   â””â”€â”€ ebpf_receiver          # Goç”¨æˆ·æ€ç¨‹åº
â”œâ”€â”€ bpf/                        # eBPFå†…æ ¸ç¨‹åº
â”‚   â”œâ”€â”€ Makefile               # eBPFæ„å»ºæ–‡ä»¶
â”‚   â””â”€â”€ probe.c                # eBPFç›‘æ§ç¨‹åº
â”œâ”€â”€ cmd/                        # Goç¨‹åºæºç 
â”‚   â””â”€â”€ ebpf_receiver/         # ç”¨æˆ·æ€äº‹ä»¶æ¥æ”¶å™¨
â”‚       â”œâ”€â”€ go.mod             # Goæ¨¡å—ä¾èµ–
â”‚       â”œâ”€â”€ go.sum             # ä¾èµ–æ ¡éªŒæ–‡ä»¶
â”‚       â””â”€â”€ main.go            # ä¸»ç¨‹åºæ–‡ä»¶
â”œâ”€â”€ docs/                       # æŠ€æœ¯æ–‡æ¡£
â”‚   â””â”€â”€ week1-2-implementation.md
â”œâ”€â”€ test/                       # æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ execve_trace.bt        # bpftraceæµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ ingest_realtime.py     # Pythonæ•°æ®é‡‡é›†å™¨
â”‚   â”œâ”€â”€ test_result.log        # æµ‹è¯•ç»“æœæ—¥å¿—
â”‚   â””â”€â”€ trigger_exec.sh        # æµ‹è¯•äº‹ä»¶è§¦å‘å™¨
â””â”€â”€ setup-ebpf.sh              # ç¯å¢ƒå®‰è£…è„šæœ¬
```

## ğŸ”§ æŠ€æœ¯å®ç°

### eBPFç¨‹åºç‰¹æ€§

**ç›‘æ§çš„ç³»ç»Ÿè°ƒç”¨:**

#### è¿›ç¨‹ç›‘æ§
- `execve`: è¿›ç¨‹æ‰§è¡Œäº‹ä»¶ - æ£€æµ‹ç¨‹åºå¯åŠ¨å’Œå‘½ä»¤æ‰§è¡Œ
- `clone`: è¿›ç¨‹åˆ›å»ºäº‹ä»¶ - æ£€æµ‹è¿›ç¨‹æ³¨å…¥å’Œå¼‚å¸¸è¿›ç¨‹åˆ›å»º
- `prctl`: è¿›ç¨‹æ§åˆ¶äº‹ä»¶ - æ£€æµ‹è¿›ç¨‹è¡Œä¸ºä¿®æ”¹

#### æ–‡ä»¶ç³»ç»Ÿç›‘æ§
- `openat`: æ–‡ä»¶æ‰“å¼€äº‹ä»¶ - æ£€æµ‹æ–‡ä»¶è®¿é—®å’Œæ•æ„Ÿæ–‡ä»¶è¯»å–
- `unlink`: æ–‡ä»¶åˆ é™¤äº‹ä»¶ - æ£€æµ‹æ—¥å¿—æ¸…ç†å’Œæ–‡ä»¶é”€æ¯
- `mount`: æ–‡ä»¶ç³»ç»ŸæŒ‚è½½äº‹ä»¶ - æ£€æµ‹æ¶æ„æŒ‚è½½æ“ä½œ

#### ç½‘ç»œç›‘æ§
- `connect`: ç½‘ç»œè¿æ¥äº‹ä»¶ - æ£€æµ‹å¤–è”é€šä¿¡
- `socket`: Socketåˆ›å»ºäº‹ä»¶ - æ£€æµ‹ç½‘ç»œæ´»åŠ¨åˆå§‹åŒ–
- `bind`: Socketç»‘å®šäº‹ä»¶ - æ£€æµ‹ç«¯å£ç›‘å¬
- `listen`: Socketç›‘å¬äº‹ä»¶ - æ£€æµ‹æœåŠ¡å¯åŠ¨
- `accept`: Socketæ¥å—è¿æ¥äº‹ä»¶ - æ£€æµ‹è¿æ¥å»ºç«‹

#### å†…å­˜å’Œæƒé™ç›‘æ§
- `mmap`: å†…å­˜æ˜ å°„äº‹ä»¶ - æ£€æµ‹ä»£ç æ³¨å…¥å’Œå†…å­˜æ“ä½œ
- `mprotect`: å†…å­˜ä¿æŠ¤ä¿®æ”¹äº‹ä»¶ - æ£€æµ‹ROP/JOPæ”»å‡»
- `setuid`: ç”¨æˆ·IDä¿®æ”¹äº‹ä»¶ - æ£€æµ‹æƒé™æå‡
- `setgid`: ç»„IDä¿®æ”¹äº‹ä»¶ - æ£€æµ‹æƒé™æå‡

#### è°ƒè¯•å’Œå†…æ ¸æ¨¡å—ç›‘æ§
- `ptrace`: è¿›ç¨‹è°ƒè¯•äº‹ä»¶ - æ£€æµ‹è°ƒè¯•å™¨é™„åŠ å’Œè¿›ç¨‹æ“ä½œ
- `init_module`: å†…æ ¸æ¨¡å—åŠ è½½äº‹ä»¶ - æ£€æµ‹Rootkitå®‰è£…
- `delete_module`: å†…æ ¸æ¨¡å—å¸è½½äº‹ä»¶ - æ£€æµ‹æ¨¡å—æ“ä½œ

**äº‹ä»¶æ•°æ®ç»“æ„:**
```c
struct event {
    __u64 timestamp;    // äº‹ä»¶æ—¶é—´æˆ³ï¼ˆçº³ç§’ï¼‰
    __u32 pid;         // è¿›ç¨‹ID
    __u32 ppid;        // çˆ¶è¿›ç¨‹ID
    __u32 uid;         // ç”¨æˆ·ID
    __u32 gid;         // ç»„ID
    __u32 event_type;  // äº‹ä»¶ç±»å‹ID
    char comm[16];     // è¿›ç¨‹å‘½ä»¤å
    char filename[256]; // æ–‡ä»¶åæˆ–è·¯å¾„
    __u64 syscall_nr;  // ç³»ç»Ÿè°ƒç”¨å·
    __s64 ret;         // ç³»ç»Ÿè°ƒç”¨è¿”å›å€¼
    
    // è”åˆä½“ï¼šæ ¹æ®äº‹ä»¶ç±»å‹å­˜å‚¨ä¸“ç”¨æ•°æ®
    union {
        struct {
            __u64 addr;      // å†…å­˜åœ°å€
            __u64 len;       // å†…å­˜é•¿åº¦
            __u32 prot;      // å†…å­˜ä¿æŠ¤æ ‡å¿—
            __u32 flags;     // å†…å­˜æ˜ å°„æ ‡å¿—
        } mem;  // å†…å­˜æ“ä½œäº‹ä»¶ï¼ˆmmapã€mprotectï¼‰
        
        struct {
            __u32 old_uid;   // åŸç”¨æˆ·ID
            __u32 new_uid;   // æ–°ç”¨æˆ·ID
        } cred; // å‡­è¯å˜æ›´äº‹ä»¶ï¼ˆsetuidã€setgidï¼‰
        
        struct {
            __u32 target_pid; // ç›®æ ‡è¿›ç¨‹ID
            __u64 request;    // ptraceè¯·æ±‚ç±»å‹
            __u64 addr;       // å†…å­˜åœ°å€
            __u64 data;       // æ•°æ®
        } ptrace; // è¿›ç¨‹è°ƒè¯•äº‹ä»¶
        
        struct {
            __u32 family;     // åè®®æ—ï¼ˆAF_INETç­‰ï¼‰
            __u32 type;       // Socketç±»å‹ï¼ˆSOCK_STREAMç­‰ï¼‰
            __u32 protocol;   // åè®®ï¼ˆIPPROTO_TCPç­‰ï¼‰
            __u16 port;       // ç«¯å£å·
            __u32 addr;       // IPåœ°å€
        } net; // ç½‘ç»œäº‹ä»¶ï¼ˆsocketã€bindã€connectç­‰ï¼‰
        
        struct {
            __u32 option;     // prctlé€‰é¡¹
            __u64 arg2;       // å‚æ•°2
            __u64 arg3;       // å‚æ•°3
            __u64 arg4;       // å‚æ•°4
            __u64 arg5;       // å‚æ•°5
        } prctl; // è¿›ç¨‹æ§åˆ¶äº‹ä»¶
        
        __u64 raw_args[6]; // åŸå§‹ç³»ç»Ÿè°ƒç”¨å‚æ•°æ•°ç»„
    } data;
};
```

### JSONè¾“å‡ºæ ¼å¼

åŸºç¡€äº‹ä»¶æ ¼å¼ï¼š
```json
{
  "timestamp": 1640995200123456789,
  "time_str": "2022-01-01 12:00:00.123456",
  "pid": 1234,
  "ppid": 1000,
  "uid": 1000,
  "gid": 1000,
  "event_type": 1,
  "event_name": "execve",
  "comm": "bash",
  "filename": "/bin/ls",
  "syscall_nr": 59,
  "ret_code": 0
}
```

å†…å­˜æ“ä½œäº‹ä»¶ï¼ˆmmap/mprotectï¼‰ï¼š
```json
{
  "timestamp": 1640995200123456789,
  "time_str": "2022-01-01 12:00:00.123456",
  "pid": 1234,
  "event_type": 9,
  "event_name": "mmap",
  "comm": "malware",
  "syscall_nr": 9,
  "ret_code": 0,
  "mem_addr": "0x7ffff7dd5000",
  "mem_len": 4096,
  "mem_prot": "PROT_READ|PROT_WRITE|PROT_EXEC",
  "mem_flags": "MAP_PRIVATE|MAP_ANONYMOUS"
}
```

æƒé™æå‡äº‹ä»¶ï¼ˆsetuid/setgidï¼‰ï¼š
```json
{
  "timestamp": 1640995200123456789,
  "time_str": "2022-01-01 12:00:00.123456",
  "pid": 1234,
  "event_type": 14,
  "event_name": "setuid",
  "comm": "sudo",
  "syscall_nr": 105,
  "ret_code": 0,
  "old_uid": 1000,
  "new_uid": 0
}
```

ç½‘ç»œäº‹ä»¶ï¼ˆsocket/connectï¼‰ï¼š
```json
{
  "timestamp": 1640995200123456789,
  "time_str": "2022-01-01 12:00:00.123456",
  "pid": 1234,
  "event_type": 3,
  "event_name": "connect",
  "comm": "wget",
  "syscall_nr": 42,
  "ret_code": 0,
  "net_family": "AF_INET",
  "net_type": "SOCK_STREAM",
  "net_protocol": "IPPROTO_TCP",
  "net_port": 80,
  "net_addr": "192.168.1.100"
}
```

### å…³é”®æŠ€æœ¯ç‰¹ç‚¹

1. **CO-REæŠ€æœ¯**: ä½¿ç”¨BTFå®ç°å†…æ ¸ç‰ˆæœ¬å…¼å®¹æ€§
2. **Ring Buffer**: é«˜æ•ˆçš„å†…æ ¸-ç”¨æˆ·æ€æ•°æ®ä¼ è¾“
3. **æ—¶é—´æˆ³å¤„ç†**: å‡†ç¡®è½¬æ¢eBPFæ—¶é—´æˆ³ä¸ºå®é™…æ—¶é—´
4. **å†…å­˜å¯¹é½**: ç²¾ç¡®åŒ¹é…å†…æ ¸å’Œç”¨æˆ·æ€æ•°æ®ç»“æ„
5. **ä¼˜é›…é€€å‡º**: å®Œå–„çš„ä¿¡å·å¤„ç†å’Œèµ„æºæ¸…ç†

## ğŸ› ï¸ ä½¿ç”¨æŒ‡å—

### åŸºç¡€ç›‘æ§

```bash
# å¯åŠ¨å®æ—¶ç›‘æ§
sudo ./bin/ebpf_receiver

# è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶
sudo ./bin/ebpf_receiver > events.json

# ç»“åˆjqè¿›è¡Œå®æ—¶åˆ†æ
sudo ./bin/ebpf_receiver | jq '.event_name'
```

### è¿‡æ»¤ç‰¹å®šäº‹ä»¶

```bash
# åªç›‘æ§execveäº‹ä»¶
sudo ./bin/ebpf_receiver | jq 'select(.event_name == "execve")'

# ç›‘æ§ç‰¹å®šç”¨æˆ·çš„æ´»åŠ¨
sudo ./bin/ebpf_receiver | jq 'select(.uid == 1000)'

# ç›‘æ§æ–‡ä»¶è®¿é—®
sudo ./bin/ebpf_receiver | jq 'select(.event_name == "openat")'
```

### å¼€å‘å’Œè°ƒè¯•

```bash
# æŸ¥çœ‹é¡¹ç›®çŠ¶æ€
make status

# æ¸…ç†é‡æ–°æ„å»º
make clean && make

# å¼€å‘æ¨¡å¼è¿è¡Œ
make dev
```

## ğŸ” ç›‘æ§èƒ½åŠ›

å½“å‰å®ç°å¯ä»¥æ£€æµ‹ä»¥ä¸‹ç³»ç»Ÿè¡Œä¸ºï¼š

### è¿›ç¨‹æ´»åŠ¨ç›‘æ§
- æ–°è¿›ç¨‹å¯åŠ¨ (execve)
- è¿›ç¨‹æ‰§è¡Œé“¾è·Ÿè¸ª
- çˆ¶å­è¿›ç¨‹å…³ç³»åˆ†æ

### æ–‡ä»¶ç³»ç»Ÿç›‘æ§
- æ–‡ä»¶æ‰“å¼€æ“ä½œ (openat)
- æ•æ„Ÿæ–‡ä»¶è®¿é—®æ£€æµ‹
- æ–‡ä»¶è®¿é—®æ¨¡å¼åˆ†æ

### ç½‘ç»œæ´»åŠ¨ç›‘æ§
- ç½‘ç»œè¿æ¥å»ºç«‹ (connect)
- å¼‚å¸¸ç½‘ç»œè¡Œä¸ºæ£€æµ‹
- è¿›ç¨‹ç½‘ç»œæ´»åŠ¨å…³è”

## ğŸš§ å¼€å‘è·¯çº¿å›¾

### å·²å®ŒæˆåŠŸèƒ½ âœ…
- [x] eBPFå†…æ ¸ç¨‹åºå®ç°
- [x] Ring Bufferæ•°æ®ä¼ è¾“
- [x] Goç”¨æˆ·æ€äº‹ä»¶å¤„ç†
- [x] JSONæ ‡å‡†åŒ–è¾“å‡º
- [x] æ—¶é—´æˆ³å‡†ç¡®è½¬æ¢
- [x] å®Œæ•´æ„å»ºç³»ç»Ÿ

### è®¡åˆ’åŠŸèƒ½ ğŸ”„
- [ ] äº‹ä»¶è¿‡æ»¤å’Œèšåˆ
- [ ] è½»é‡çº§è§„åˆ™å¼•æ“
- [ ] æ•°æ®å­˜å‚¨åç«¯
- [ ] Webå¯è§†åŒ–ç•Œé¢
- [ ] æ”»å‡»é“¾åˆ†æ
- [ ] å¼‚å¸¸æ£€æµ‹ç®—æ³•

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç å’Œå»ºè®®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ™ è‡´è°¢

- [eBPF ç¤¾åŒº](https://ebpf.io/) - æä¾›å¼ºå¤§çš„å†…æ ¸ç¼–ç¨‹æ¡†æ¶
- [cilium/ebpf](https://github.com/cilium/ebpf) - ä¼˜ç§€çš„Go eBPFåº“
- [libbpf](https://github.com/libbpf/libbpf) - eBPFç”¨æˆ·æ€åº“

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: https://github.com/2577552541/eTracee
- é—®é¢˜åé¦ˆ: https://github.com/2577552541/eTracee/issues

---

**eTracee** - è®©ç³»ç»Ÿè¡Œä¸ºä¸€ç›®äº†ç„¶ ğŸ”